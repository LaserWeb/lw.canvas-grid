!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("CanvasGrid",[],t):"object"==typeof exports?exports.CanvasGrid=t():e.CanvasGrid=t()}(this,function(){return function(e){function t(a){if(i[a])return i[a].exports;var n=i[a]={exports:{},id:a,loaded:!1};return e[a].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){e.exports=i(1)},function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasGrid=void 0;var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),o=i(2),r=a(o),l=function(){function e(t){n(this,e),this.cellSize=1024,this.scaleRatio={x:1,y:1},this.filters={},Object.assign(this,t||{}),this.scaleRatio.x||(this.scaleRatio={x:this.scaleRatio,y:this.scaleRatio}),this.size={width:0,height:0,cols:0,rows:0},this.file=null,this.image=null,this.url=null,this.canvas=[],this.pixels=[]}return s(e,[{key:"load",value:function(e){return e instanceof File?this.loadFromFile(e):e instanceof Image?this.loadFromImage(e):"string"==typeof e||e instanceof URL?this.loadFromURL(e.trim()):Promise.reject(new Error("Unsupported input format."))}},{key:"_loadImage",value:function(e,t,i){var a=this,n=new Image;n.onload=function(e){a.loadFromImage(n).then(i).catch(t)},n.onerror=function(i){t(new Error("An error occurred while loading the image : "+e))},n.src=e}},{key:"loadFromFile",value:function(e){var t=this;return new Promise(function(i,a){e instanceof File||a(new Error("Input param must be a File object.")),t.file=e,t._loadImage(URL.createObjectURL(e),a,i)})}},{key:"loadFromURL",value:function(e){var t=this;return new Promise(function(i,a){e instanceof URL||"string"==typeof e||a(new Error("Input param must be a URL string or object."));var n=e instanceof URL?e:new URL(e);t.url=n,t._loadImage(n,a,i)})}},{key:"loadFromImage",value:function(e){var t=this;return new Promise(function(i,a){e instanceof Image||a(new Error("Input param must be a Image object.")),t.image=e,t._processImage(),i(t)})}},{key:"_processImage",value:function(){this.canvas=[],this.pixels=[];var e=Math.round(this.image.width*this.scaleRatio.x),t=Math.round(this.image.height*this.scaleRatio.y),i=Math.ceil(e/this.cellSize),a=Math.ceil(t/this.cellSize);this.size={width:e,height:t,cols:i,rows:a};var n=null,s=null,o=null,l=null,h=null,c=null,u=null,d=null,m=null,f=null;for(c=0;c<this.size.rows;c++){for(n=[],o=[],h=0;h<this.size.cols;h++)s=document.createElement("canvas"),0===h||h<this.size.cols-1?s.width=this.size.width<this.cellSize?this.size.width:this.cellSize:s.width=this.size.width%this.cellSize,0===c||c<this.size.rows-1?s.height=this.size.height<this.cellSize?this.size.height:this.cellSize:s.height=this.size.height%this.cellSize,l=s.getContext("2d"),l.fillStyle="white",l.fillRect(0,0,s.width,s.height),m=s.width/this.scaleRatio.x,f=s.height/this.scaleRatio.y,u=h*this.cellSize/this.scaleRatio.x,d=c*this.cellSize/this.scaleRatio.y,l.drawImage(this.image,u,d,m,f,0,0,s.width,s.height),(0,r.default)(s,this.filters),n.push(s),o.push(l.getImageData(0,0,s.width,s.height).data);this.pixels.push(o),this.canvas.push(n)}}},{key:"getPixel",value:function(e,t){if(e=parseInt(e),t=parseInt(t),isNaN(e)||isNaN(t))throw new Error("[x, y] params must be Integer.");if(e<0||e>=this.size.width)throw new Error("Out of range: x = "+e+", max: "+this.size.width);if(t<0||t>=this.size.height)throw new Error("Out of range: y = "+t+", max: "+this.size.height);var i=parseInt(e/this.cellSize),a=parseInt(t/this.cellSize);i&&(e-=this.cellSize*i),a&&(t-=this.cellSize*a);var n=this.cellSize;this.size.width<n?n=this.size.width:this.size.width<n*(i+1)&&(n=this.size.width%n);var s=t*(4*n)+4*e,o=this.pixels[a][i],r=o.slice(s,s+4);return{color:{r:r[0],g:r[1],b:r[2],a:r[3]},gray:(r[0]+r[1]+r[2])/3,grid:{col:i,row:a},coords:{x:e,y:t}}}}]),e}();t.CanvasGrid=l,t.default=l},function(e,t,i){!function(t,i){e.exports=i()}(this,function(){return function(e){function t(a){if(i[a])return i[a].exports;var n=i[a]={exports:{},id:a,loaded:!1};return e[a].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){e.exports=i(1)},function(e,t){"use strict";function i(e){return e<0?0:e>255?255:e}function a(e,t,a){a&&(e[t]=i(255-e[t]),e[t+1]=i(255-e[t+1]),e[t+2]=i(255-e[t+2]))}function n(e,t,a){void 0!==a&&(e[t]=i(e[t]+a),e[t+1]=i(e[t+1]+a),e[t+2]=i(e[t+2]+a))}function s(e,t,a){void 0!==a&&(e[t]=i(a*(e[t]-128)+128),e[t+1]=i(a*(e[t+1]-128)+128),e[t+2]=i(a*(e[t+2]-128)+128))}function o(e,t,a){void 0!==a&&(e[t]=i(Math.exp(Math.log(255*(e[t]/255))*a)),e[t+1]=i(Math.exp(Math.log(255*(e[t+1]/255))*a)),e[t+2]=i(Math.exp(Math.log(255*(e[t+2]/255))*a)))}function r(e,t,a,n){if(h.indexOf(a)===-1)throw new Error("Unsupported grayscale algorithm: "+a);if("none"===a)return null;var s=void 0,o=e[t],r=e[t+1],l=e[t+2];switch(a){case"average":s=(o+r+l)/3;break;case"luma":s=.3*o+.59*r+.11*l;break;case"luma-601":s=.299*o+.587*r+.114*l;break;case"luma-709":s=.2126*o+.7152*r+.0722*l;break;case"luma-240":s=.212*o+.701*r+.087*l;break;case"desaturation":s=(Math.max(o,r,l)+Math.min(o,r,l))/2;break;case"decomposition-min":s=Math.min(o,r,l);break;case"decomposition-max":s=Math.max(o,r,l);break;case"red-chanel":s=o;break;case"green-chanel":s=r;break;case"blue-chanel":s=l}void 0!==n&&(s=parseInt(s/n)*n),s=parseInt(s),e[t]=i(s),e[t+1]=i(s),e[t+2]=i(s)}function l(e,t){t=Object.assign({},{smoothing:!1,brightness:0,contrast:0,gamma:0,grayscale:"none",shadesOfGray:256,invertColor:!1},t||{});var i=e.getContext("2d");void 0!==i.imageSmoothingEnabled?i.imageSmoothingEnabled=t.smoothing:(i.mozImageSmoothingEnabled=t.smoothing,i.webkitImageSmoothingEnabled=t.smoothing,i.msImageSmoothingEnabled=t.smoothing,i.oImageSmoothingEnabled=t.smoothing);var l=i.getImageData(0,0,e.width,e.height),h=l.data,c=void 0,u=void 0,d=void 0,m=void 0;0!==t.contrast&&(c=259*(t.contrast+255)/(255*(259-t.contrast))),0!==t.brightness&&(u=t.brightness),0!==t.gamma&&(d=1/t.gamma),t.shadesOfGray>1&&t.shadesOfGray<256&&(m=255/(t.shadesOfGray-1));for(var f=0,g=h.length;f<g;f+=4)a(h,f,t.invertColor),n(h,f,u),s(h,f,c),o(h,f,d),r(h,f,t.grayscale,m);i.putImageData(l,0,0)}Object.defineProperty(t,"__esModule",{value:!0});var h=["none","average","desaturation","decomposition-min","decomposition-max","luma","luma-601","luma-709","luma-240","red-chanel","green-chanel","blue-chanel"];t.canvasFilters=l,t.default=l}])})}])});
//# sourceMappingURL=lw.canvas-grid.min.js.map