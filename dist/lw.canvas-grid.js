!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("CanvasGrid",[],t):"object"==typeof exports?exports.CanvasGrid=t():e.CanvasGrid=t()}(this,function(){return function(e){function t(a){if(i[a])return i[a].exports;var n=i[a]={exports:{},id:a,loaded:!1};return e[a].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){e.exports=i(1)},function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasGrid=void 0;var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),s=i(2),r=a(s),l=function(){function e(t){n(this,e),this.cellSize=1024,this.scaleRatio=1,this.filters={},Object.assign(this,t||{}),this.size={width:0,height:0,cols:0,rows:0},this.file=null,this.image=null,this.url=null,this.src=null,this.canvas=[],this.pixels=[]}return o(e,[{key:"load",value:function(e){return e instanceof File?this.loadFromFile(e):e instanceof Image?this.loadFromImage(e):"string"==typeof e||e instanceof URL?this.loadFromURL(e.trim()):Promise.reject(new Error("Unsupported input format."))}},{key:"_loadImage",value:function(e,t,i){var a=this,n=new Image;n.onload=function(o){a.loadFromImage(n).then(function(t){a._processImage(),a.src=e,i(t)}).catch(t)},n.onerror=function(i){t(new Error("Error reading file : "+e))},n.src=e}},{key:"loadFromFile",value:function(e){var t=this;return new Promise(function(i,a){e instanceof File||a(new Error("Input param must be a File object.")),t.file=e,t._loadImage(URL.createObjectURL(e),a,i)})}},{key:"loadFromURL",value:function(e){var t=this;return new Promise(function(i,a){e instanceof URL||"string"==typeof e||a(new Error("Input param must be a URL string or object."));var n=e instanceof URL?e:new URL(e);t.url=n,t._loadImage(n,a,i)})}},{key:"loadFromImage",value:function(e){var t=this;return new Promise(function(i,a){e instanceof Image||a(new Error("Input param must be a Image object.")),t.image=e,i(t)})}},{key:"_processImage",value:function(){this.canvas=[],this.pixels=[];var e=this.image.width*this.scaleRatio,t=this.image.height*this.scaleRatio,i=Math.ceil(e/this.cellSize),a=Math.ceil(t/this.cellSize);this.size={width:e,height:t,cols:i,rows:a};var n=null,o=null,s=null,l=null,c=null,h=null,u=null,d=null,f=null;for(c=0;c<this.size.rows;c++){for(n=[],l=0;l<this.size.cols;l++)o=document.createElement("canvas"),0===l||l<this.size.cols-1?o.width=this.size.width<this.cellSize?this.size.width:this.cellSize:o.width=this.size.width%this.cellSize,0===c||c<this.size.rows-1?o.height=this.size.height<this.cellSize?this.size.height:this.cellSize:o.height=this.size.height%this.cellSize,s=o.getContext("2d"),s.fillStyle="white",s.fillRect(0,0,o.width,o.height),h=o.width/this.scaleRatio,u=o.height/this.scaleRatio,d=l*this.cellSize/this.scaleRatio,f=c*this.cellSize/this.scaleRatio,s.drawImage(this.image,d,f,h,u,0,0,o.width,o.height),(0,r.default)(o,this.filters),n.push(o);this.canvas.push(n)}}},{key:"applyFilters",value:function(e){var t=this;Object.assign(this.filters,e||{}),this.canvas.forEach(function(e){return(0,r.default)(e,t.filters)})}}]),e}();t.CanvasGrid=l,t.default=l},function(e,t,i){!function(t,i){e.exports=i()}(this,function(){return function(e){function t(a){if(i[a])return i[a].exports;var n=i[a]={exports:{},id:a,loaded:!1};return e[a].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){e.exports=i(1)},function(e,t){"use strict";function i(e){return e<0?0:e>255?255:e}function a(e,t,a){void 0!==a&&(e[t]=i(e[t]+a),e[t+1]=i(e[t+1]+a),e[t+2]=i(e[t+2]+a))}function n(e,t,a){void 0!==a&&(e[t]=i(a*(e[t]-128)+128),e[t+1]=i(a*(e[t+1]-128)+128),e[t+2]=i(a*(e[t+2]-128)+128))}function o(e,t,a){void 0!==a&&(e[t]=i(Math.exp(Math.log(255*(e[t]/255))*a)),e[t+1]=i(Math.exp(Math.log(255*(e[t+1]/255))*a)),e[t+2]=i(Math.exp(Math.log(255*(e[t+2]/255))*a)))}function s(e,t,a,n){if(l.indexOf(a)===-1)throw new Error("Unsupported grayscale algorithm: "+a);if("none"===a)return null;var o=void 0,s=e[t],r=e[t+1],c=e[t+2];switch(a){case"average":o=(s+r+c)/3;break;case"luma":o=.3*s+.59*r+.11*c;break;case"luma-601":o=.299*s+.587*r+.114*c;break;case"luma-709":o=.2126*s+.7152*r+.0722*c;break;case"luma-240":o=.212*s+.701*r+.087*c;break;case"desaturation":o=(Math.max(s,r,c)+Math.min(s,r,c))/2;break;case"decomposition-min":o=Math.min(s,r,c);break;case"decomposition-max":o=Math.max(s,r,c);break;case"red-chanel":o=s;break;case"green-chanel":o=r;break;case"blue-chanel":o=c}void 0!==n&&(o=parseInt(o/n)*n),o=parseInt(o),e[t]=i(o),e[t+1]=i(o),e[t+2]=i(o)}function r(e,t){t=Object.assign({},{smoothing:!1,brightness:0,contrast:0,gamma:0,grayscale:"none",shadesOfGray:256},t||{});var i=e.getContext("2d");void 0!==i.imageSmoothingEnabled?i.imageSmoothingEnabled=t.smoothing:(i.mozImageSmoothingEnabled=t.smoothing,i.webkitImageSmoothingEnabled=t.smoothing,i.msImageSmoothingEnabled=t.smoothing,i.oImageSmoothingEnabled=t.smoothing);var r=i.getImageData(0,0,e.width,e.height),l=r.data,c=void 0,h=void 0,u=void 0,d=void 0;0!==t.contrast&&(c=259*(t.contrast+255)/(255*(259-t.contrast))),0!==t.brightness&&(h=t.brightness),0!==t.gamma&&(u=1/t.gamma),t.shadesOfGray>1&&t.shadesOfGray<256&&(d=255/(t.shadesOfGray-1));for(var f=0,m=l.length;f<m;f+=4)a(l,f,h),n(l,f,c),o(l,f,u),s(l,f,t.grayscale,d);i.putImageData(r,0,0)}Object.defineProperty(t,"__esModule",{value:!0});var l=["average","desaturation","decomposition","luma","luma-601","luma-709","luma-240","red-chanel","green-chanel","blue-chanel","none"];t.canvasFilters=r,t.default=r}])})}])});
//# sourceMappingURL=lw.canvas-grid.js.map